
# alloc(size:ptr)
fun{inline, asm} alloc(u64:u64) {
    "dup64"
    "alloc"
    "addU64"
}

fun{inline, asm} popSp(u64:) {
    "popSp"
}

fun{inline, asm} popCs(u64:) {
    "popCs"
}

fun{inline, asm} debug(:) {
    "debug"
}

fun{inline, asm} halt(:) {
    "halt"
}

fun{inline, asm} write(u64,u64:u64) {
    "write"
}

fun{inline, asm} drop(u64:) {
    "drop64"
}

fun __start(:) {
    4000u64 alloc(u64:u64)
    popSp(u64:)

    1000u64 alloc(u64:u64)
    popCs(u64:)

    main(:)

    halt(:)
}

fun main(:) {
    test(:)
}

fun test(:) {
    "hello\n" write(u64,u64:u64)
    drop(u64:)
}
